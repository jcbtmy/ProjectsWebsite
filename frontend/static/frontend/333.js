(self.webpackChunksite=self.webpackChunksite||[]).push([[333],{1803:(t,e,n)=>{"use strict";n.d(e,{Z:()=>m});var a=n(4575),r=n.n(a),s=n(3913),o=n.n(s),i=n(2205),c=n.n(i),u=n(8585),l=n.n(u),p=n(9754),f=n.n(p),h=n(7294);var m=function(t){c()(s,t);var e,n,a=(e=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,a=f()(e);if(n){var r=f()(this).constructor;t=Reflect.construct(a,arguments,r)}else t=a.apply(this,arguments);return l()(this,t)});function s(){return r()(this,s),a.apply(this,arguments)}return o()(s,[{key:"render",value:function(){return h.createElement("div",{className:"spinner-border",role:"status"},h.createElement("span",{className:"sr-only"},"Loading..."))}}]),s}(h.Component)},1333:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>R});var a=n(7757),r=n.n(a),s=n(8926),o=n.n(s),i=n(319),c=n.n(i),u=n(4575),l=n.n(u),p=n(3913),f=n.n(p),h=n(2205),m=n.n(h),v=n(8585),d=n.n(v),y=n(9754),S=n.n(y),k=n(7294),g=n(3822),b=n(7912),x=n(2388),M=n(25),D=n(9795),E=n(8836),T=n(1803);function A(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,a=S()(t);if(e){var r=S()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return d()(this,n)}}function W(t){var e=parseFloat(t);return Math.floor(9*e/5+32).toString()}function w(t){var e=3.28084*parseFloat(t);return e.toFixed(2)}var C=function(t){m()(n,t);var e=A(n);function n(){var t,a;l()(this,n);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return d()(a,(t=a=e.call.apply(e,[this].concat(s)),a.markerClick=function(t){console.log(t.key);for(var e=t.latlng,n=JSON.stringify([e.lat,e.lng]),r=a.props.stations,s=0;s<r.length;s++)n===JSON.stringify(r[s].coordinates)&&a.props.clickEvent(r[s])},t))}return f()(n,[{key:"displayMarkers",value:function(){var t=this;return this.props.stations.map((function(e){return k.createElement(x.Z,{key:e.value,position:e.coordinates,onMouseOver:function(t){t.target.openPopup()},onMouseOut:function(t){t.target.closePopup()},onClick:t.markerClick},k.createElement(M.Z,null,e.label))}))}},{key:"render",value:function(){return k.createElement("div",{className:"Map"},k.createElement(D.Z,{center:this.props.currentStation.coordinates,zoom:11},k.createElement(E.Z,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'© <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}),this.displayMarkers()))}}]),n}(k.Component);function P(t){var e=t.temps,n=[];return e?("MM"!==e.WTMP&&n.push(k.createElement("p",{key:"WTMP"},"Water Temperature: ",W(e.WTMP),"℉")),"MM"!==e.ATMP&&n.push(k.createElement("p",{key:"ATMP"},"Air Temperature: ",W(e.ATMP),"℉")),n):null}function L(t){var e=t.stationWaves.map((function(t){return{x:t.time,y:parseFloat(w(t.WVHT))}})),n=e.map((function(t){return t.y})),a=Math.max.apply(Math,c()(n)),r=Math.min.apply(Math,c()(n)),s=.1*Math.abs(a-r),o={axisY:{title:"Wave Height",maximum:a+s,minimum:r-s},axisX:{interval:4,intervalType:"hour",xValueFormatString:"DD-hh"},height:160,data:[{type:"splineArea",name:"Wave Height ft",xValueType:"dateTime",xValueFormatString:"D MMM hh:mm TT",connectNullData:!0,dataPoints:e}]};return k.createElement("div",{className:"Chart"},k.createElement(b.x,{options:o}))}function N(t){var e=t.stationWaves;console.log(e);var n=e[e.length-1].WVHT;return k.createElement("div",{className:"SurfText"},k.createElement("h2",null,k.createElement("b",null,t.stationName)),k.createElement("h2",null,k.createElement("b",null,"Wave Height: ",w(n).toString()," ft")),k.createElement(P,{temps:t.stationTemps}),k.createElement(L,{stationWaves:e}))}var R=function(t){m()(i,t);var e,n,a,s=A(i);function i(t){var e;return l()(this,i),(e=s.call(this,t)).handleSelectStation=function(t){e.setState({isLoaded:!1,notAvailable:!1,selectedStation:null}),e.checkforSpecData(t.value).then((function(n){n?e.setState({selectedStation:t,specData:e.parseSpectralData(n),isLoaded:!0}):e.setState({notAvailable:!0})})).catch((function(t){e.setState({error:t,isLoaded:!0,notAvailable:!0})})),e.getWeatherData(t.value).then((function(t){e.setState({tempData:e.parseWeatherData(t)})})).catch((function(t){e.setState({error:t,isLoaded:!0,notAvailable:!0})}))},e.state={error:null,isLoaded:!1,selectedStation:null,tempData:null,specData:null,stations:null,notAvailable:!1},e.damnStation="LJAC1",e.ndbc_cors="https://cors-anywhere.herokuapp.com/https://www.ndbc.noaa.gov/",e}return f()(i,[{key:"componentDidMount",value:function(){var t=this;this.getActiveStations().then((function(e){t.setState({isLoaded:!0,stations:e})}))}},{key:"checkforSpecData",value:(a=o()(r().mark((function t(e){var n,a;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.ndbc_cors.concat("data/realtime2/",e,".spec"),t.next=3,fetch(n);case 3:if(200!==(a=t.sent).status){t.next=10;break}return t.next=7,a.text();case 7:t.t0=t.sent,t.next=11;break;case 10:t.t0=!1;case 11:return t.abrupt("return",t.t0);case 12:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"getWeatherData",value:(n=o()(r().mark((function t(e){var n,a;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e="LJPC1"!==e?e:"LJAC1",n=this.ndbc_cors.concat("data/realtime2/",e,".txt"),t.next=4,fetch(n);case 4:if(200!==(a=t.sent).status){t.next=11;break}return t.next=8,a.text();case 8:t.t0=t.sent,t.next=12;break;case 11:t.t0=!1;case 12:return t.abrupt("return",t.t0);case 13:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"getActiveStations",value:(e=o()(r().mark((function t(){var e,n,a;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={"Content-Type":"application/json"},t.next=3,fetch("/station-api/stations/",{headers:e});case 3:return n=t.sent,t.next=6,n.json();case 6:return a=t.sent,t.abrupt("return",this.parseActiveStations(a));case 8:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"parseActiveStations",value:function(t){for(var e=t.length,n=[],a=0;a<e;a++)n.push({value:t[a].station_id,label:t[a].name,coordinates:[t[a].lat,t[a].lon]});return n}},{key:"parseSpectralData",value:function(t){var e,n=new Date,a=t.split("\n"),r=[];e=a.length,n.setTime(n.getTime()-864e5);for(var s=2;s<e-1;s++){var o=a[s].match(/\S+/g),i=parseInt(o[0]),c=parseInt(o[1])-1,u=parseInt(o[2]),l=parseInt(o[3]),p=parseInt(o[4]),f=new Date(Date.UTC(i,c,u,l,p));if(f<n)break;r.unshift({time:f,WVHT:o[5],steepness:o[12]})}return r}},{key:"parseWeatherData",value:function(t){var e=t.split("\n")[2].match(/\S+/g);return{ATMP:e[13],WTMP:e[14]}}},{key:"notAvailable",value:function(){return k.createElement("h1",null,"Station data not available")}},{key:"render",value:function(){var t=this.state,e=t.error,n=t.isLoaded,a=t.selectedStation,r=t.stations,s=t.tempData,o=t.specData;return t.notAvailable,k.createElement("div",{className:"SurfApp"},e&&e.message,!n&&k.createElement(T.Z,null),n&&k.createElement(g.ZP,{value:a,onChange:this.handleSelectStation,options:r}),a&&k.createElement(C,{currentStation:a,stations:r,clickEvent:this.handleSelectStation}),a&&k.createElement(N,{stationName:a.label,stationWaves:o,stationTemps:s}))}}]),i}(k.Component)}}]);